2025-11-07 20:01:35,304 - INFO - --- Starting Data Loading ---
2025-11-07 20:01:35,362 - INFO - Loaded data\prc-2025-datasets\flightlist_train.parquet and data\prc-2025-datasets\fuel_train.parquet
2025-11-07 20:01:35,363 - INFO - --- Enriching Fuel Segments with Trajectory Data ---
2025-11-07 20:01:35,363 - INFO - This step may take a while as it processes each segment...
2025-11-07 20:40:09,069 - INFO - Successfully enriched 60877 segments.
2025-11-07 20:40:09,072 - INFO - Head of enriched fuel segments:
   idx     flight_id                   start                     end  fuel_kg  avg_altitude  avg_mach  avg_vertical_rate
0    0  prc770822360 2025-04-13 02:31:04.447 2025-04-13 03:01:04.487   2500.0  35988.585001     0.860          -3.360382
1    1  prc770822360 2025-04-13 03:01:04.487 2025-04-13 03:16:04.226   1200.0  35989.290344     0.860         -29.862213
2    2  prc770822360 2025-04-13 03:16:04.458 2025-04-13 03:46:04.417   2500.0  35988.990605     0.860         -36.040854
3    3  prc770822360 2025-04-13 03:46:04.417 2025-04-13 04:01:04.540   1300.0  35988.474983     0.860         -34.457429
4    4  prc770822360 2025-04-13 04:01:04.540 2025-04-13 04:16:04.263    600.0  29491.527367     0.725       -1531.863118
2025-11-07 20:40:09,074 - INFO - --- Performing Feature Engineering on Segments ---
2025-11-07 20:40:09,144 - INFO - Head of feature-engineered segment data:
      flight_id aircraft_type  fuel_flow_kg_s flight_phase   altitude_bin
0  prc770822360          B789        1.388858       Cruise  35000-40000ft
1  prc770822360          B789        1.333720       Cruise  35000-40000ft
2  prc770822360          B789        1.388921       Cruise  35000-40000ft
3  prc770822360          B789        1.444247       Cruise  35000-40000ft
4  prc770822360          B789        0.666872      Descent  25000-30000ft
2025-11-07 20:40:09,144 - INFO - --- Normalizing Fuel Flow to Estimate Segment Load Factor ---
2025-11-07 20:40:09,171 - INFO - Head of data with estimated segment load factor:
      flight_id  segment_load_factor
0  prc770822360             0.816476
1  prc770822360             0.664275
2  prc770822360             0.816648
3  prc770822360             0.969370
4  prc770822360             1.000000
2025-11-07 20:40:09,172 - INFO - --- Aggregating Load Factors to Flight and Airport Pair ---
2025-11-07 20:40:09,187 - INFO - Head of final average load factor by airport pair:
  origin_icao destination_icao  average_load_factor
0        CYUL             DTTA             0.012381
1        CYUL             MSLP             0.162929
2        CYUL             SKBO             0.163885
3        CYVR             RCTP             0.188331
4        CYYZ             MSLP             0.233936
2025-11-07 20:40:09,189 - INFO - --- Saving Results to data\processed\average_load_factor_by_airport_pair_v3.csv ---
2025-11-07 20:40:09,197 - INFO - Process completed successfully.
