2025-11-07 19:23:56,525 - INFO - --- Starting Data Loading ---
2025-11-07 19:23:56,569 - INFO - Loaded data\prc-2025-datasets\flightlist_train.parquet
2025-11-07 19:23:56,573 - INFO - Head of flightlist_train:
  flight_date aircraft_type             takeoff              landed origin_icao                            origin_name destination_icao                             destination_name     flight_id
0  2025-04-12          B789 2025-04-12 16:15:35 2025-04-13 04:33:52        WMKK     Kuala Lumpur International Airport             EHAM                   Amsterdam Schiphol Airport  prc770822360
1  2025-04-12          A359 2025-04-12 16:40:41 2025-04-13 03:10:15        ZSPD  Shanghai Pudong International Airport             NZAA                             Auckland Airport  prc770831136
2  2025-04-12          A359 2025-04-12 17:01:38 2025-04-13 06:10:27        ZSPD  Shanghai Pudong International Airport             LEMD                       Madrid Barajas Airport  prc770835414
3  2025-04-12          B789 2025-04-12 17:53:11 2025-04-13 05:05:13        ZSPD  Shanghai Pudong International Airport             LHBP  Budapest Ferenc Liszt International Airport  prc770844923
4  2025-04-12          B789 2025-04-12 18:05:27 2025-04-13 06:23:52        ZSPD  Shanghai Pudong International Airport             LFML                   Marseille Provence Airport  prc770847190
2025-11-07 19:23:56,590 - INFO - Loaded data\prc-2025-datasets\fuel_train.parquet
2025-11-07 19:23:56,592 - INFO - Head of fuel_train:
   idx     flight_id                   start                     end  fuel_kg
0    0  prc770822360 2025-04-13 02:31:04.447 2025-04-13 03:01:04.487   2500.0
1    1  prc770822360 2025-04-13 03:01:04.487 2025-04-13 03:16:04.226   1200.0
2    2  prc770822360 2025-04-13 03:16:04.458 2025-04-13 03:46:04.417   2500.0
3    3  prc770822360 2025-04-13 03:46:04.417 2025-04-13 04:01:04.540   1300.0
4    4  prc770822360 2025-04-13 04:01:04.540 2025-04-13 04:16:04.263    600.0
2025-11-07 19:23:56,599 - INFO - Loaded data\acPerf\acPerfOpenAP.csv
2025-11-07 19:23:56,616 - INFO - Head of acPerfOpenAP:
  ICAO_TYPE_CODE         aircraft      mtow       mlw      oew       mfc    vmo     mmo  ceiling  pax_max  pax_low  pax_high  fuselage_length  fuselage_height  fuselage_width  wing_area  wing_span  wing_mac  wing_sweep  wing_t/c      flaps_type  flaps_area  flaps_bf/b  flaps_lambda_f  flaps_cf/c  flaps_Sf/S  cruise_height  cruise_mach  cruise_range engine_type engine_mount  engine_number engine_default engine_options_A320-271N engine_options_A320-272N engine_options_A320-273N engine_options_A320-251N engine_options_A320-252N engine_options_A320-253N  drag_cd0   drag_k    drag_e  drag_gears fuel_aircraft  fuel_engine  fuel_fuel_coef  limits_MTOW  limits_MLW  limits_OEW  limits_MFC  limits_VMO  limits_MMO  limits_ceiling engine_options_A321-271N engine_options_A321-272N engine_options_A321-251N engine_options_A321-252N engine_options_A321-253N engine_options_A318-111 engine_options_A318-112 engine_options_A318-121 engine_options_A318-122 engine_options_A319-111 engine_options_A319-112 engine_options_A319-113 engine_options_A319-114 engine_options_A319-115 engine_options_A319-131 engine_options_A319-132 engine_options_A319-133 engine_options_A320-111 engine_options_A320-211 engine_options_A320-212 engine_options_A320-214 engine_options_A320-215 engine_options_A320-216 engine_options_A320-231 engine_options_A320-232 engine_options_A320-233 engine_options_A321-111 engine_options_A321-112 engine_options_A321-131 engine_options_A321-211 engine_options_A321-212 engine_options_A321-213 engine_options_A321-231 engine_options_A321-232 engine_options_A330-201 engine_options_A330-202 engine_options_A330-203 engine_options_A330-223 engine_options_A330-223F engine_options_A330-243 engine_options_A330-301 engine_options_A330-302 engine_options_A330-303 engine_options_A330-321 engine_options_A330-322 engine_options_A330-323 engine_options_A330-341 engine_options_A330-342 engine_options_A330-343 engine_options_A350-941 engine_options_A380-841 engine_options_A380-842 engine_options_A380-861 engine_options  clean_cd0  clean_k  clean_e  clean_gears
0           A20N   Airbus A320neo   79000.0   66000.0  44300.0  29700.00  350.0  0.8200  12500.0   194.00   150.00    180.00         37.57000          4.14000          3.9500    124.000   35.80000  4.290000     25.0000   0.10920  single-slotted     21.1000    0.780000             0.9    0.176000    0.170000        11000.0     0.780000        6300.0    turbofan         wing           2.00     PW1127G-JM               PW1127G-JM              PW1124G1-JM               PW1129G-JM                LEAP-1A26                LEAP-1A24                LEAP-1A29  0.017000  0.03800  0.807000    0.017000   Airbus A320  CFM56-5B4/P        2.659422      79000.0     66000.0     44300.0    29700.00       350.0      0.8200         12500.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            NaN       0.02    0.042    0.797        0.018
1           A21N   Airbus A321neo   97000.0   77800.0  50000.0  33000.00  350.0  0.8200  12500.0   244.00   180.00    220.00         44.51000          4.14000          3.9500    128.000   35.80000  4.290000     25.0000   0.10856  double-slotted     21.1000    0.780000             0.9    0.176000    0.170000        11000.0     0.780000        7400.0    turbofan         wing           2.00     PW1133G-JM                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN  0.017000  0.03800  0.807000    0.017000           NaN  CFM56-5B4/P        2.659422      97000.0     77800.0     50000.0    33000.00       350.0      0.8200         12500.0               PW1133G-JM               PW1130G-JM                LEAP-1A32                LEAP-1A30                LEAP-1A33                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            NaN       0.02    0.042    0.797        0.018
2           A306  Airbus A300-600  178989.0  142716.5  85905.0  85021.15  343.6  0.8461  12668.0   319.66   210.83    262.68         50.84445          4.95875          4.7902    250.632   46.29565  5.879015     27.4645   0.10200             NaN     38.1902    0.762642             0.9    0.170045    0.163255        11000.0     0.799675        7660.0    turbofan          NaN           2.04            NaN                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN  0.019855  0.04023  0.786025    0.016408           NaN          NaN        4.707165     178989.0    142716.5     85905.0    85021.15       343.6      0.8461         12668.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            NaN       0.02    0.042    0.797        0.018
3           A318      Airbus A318   68000.0   57500.0  39500.0  24210.00  350.0  0.8200  12500.0   136.00   107.00    117.00         31.44000          4.14000          3.9500    122.400   34.10000  4.193500     25.0000   0.10936  single-slotted     21.1000    0.780000             0.9    0.176000    0.170000        11000.0     0.780000        2800.0    turbofan         wing           2.00      CFM56-5B9                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN  0.020000  0.03900  0.783000    0.017000           NaN  CFM56-5B9/3        2.031140      68000.0     57500.0     39500.0    24210.00       350.0      0.8200         12500.0                      NaN                      NaN                      NaN                      NaN                      NaN               CFM56-5B8               CFM56-5B9                 PW6122A                 PW6124A                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            NaN       0.02    0.042    0.797        0.018
4           A319      Airbus A319   75500.0   62500.0  40800.0  30190.00  350.0  0.8200  12500.0   156.00   110.00    140.00         33.84000          4.14000          3.9500    124.000   35.80000  4.193500     25.0000   0.10936  single-slotted     21.1000    0.780000             0.9    0.176000    0.170000        11000.0     0.780000        3300.0    turbofan         wing           2.00       V2524-A5                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN  0.020000  0.03900  0.783000    0.017000           NaN     V2524-A5        2.333573      75500.0     62500.0     40800.0    30190.00       350.0      0.8200         12500.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN               CFM56-5B5               CFM56-5B6               CFM56-5A4               CFM56-5A5               CFM56-5B7                V2522-A5                V2524-A5               V2527M-A5                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            NaN       0.02    0.042    0.797        0.018
2025-11-07 19:23:56,617 - INFO - --- Data Loading Complete ---
2025-11-07 19:23:56,617 - INFO - --- Starting Data Preprocessing ---
2025-11-07 19:23:56,617 - INFO - Calculating total fuel per flight...
2025-11-07 19:23:56,633 - INFO - Head of total_fuel_per_flight:
      flight_id  total_fuel_kg
0  prc770822360    8100.000000
1  prc770831136   15094.180984
2  prc770835414   12480.130288
3  prc770844923    1200.204432
4  prc770847190    2299.711440
2025-11-07 19:23:56,634 - INFO - Merging datasets...
2025-11-07 19:23:56,678 - INFO - Final merged dataset head:
  flight_date aircraft_type             takeoff              landed origin_icao                            origin_name destination_icao                             destination_name     flight_id  total_fuel_kg ICAO_TYPE_CODE         aircraft      mtow       mlw       oew       mfc    vmo   mmo  ceiling  pax_max  pax_low  pax_high  fuselage_length  fuselage_height  fuselage_width  wing_area  wing_span  wing_mac  wing_sweep  wing_t/c      flaps_type  flaps_area  flaps_bf/b  flaps_lambda_f  flaps_cf/c  flaps_Sf/S  cruise_height  cruise_mach  cruise_range engine_type engine_mount  engine_number engine_default engine_options_A320-271N engine_options_A320-272N engine_options_A320-273N engine_options_A320-251N engine_options_A320-252N engine_options_A320-253N  drag_cd0  drag_k  drag_e  drag_gears fuel_aircraft fuel_engine  fuel_fuel_coef  limits_MTOW  limits_MLW  limits_OEW  limits_MFC  limits_VMO  limits_MMO  limits_ceiling engine_options_A321-271N engine_options_A321-272N engine_options_A321-251N engine_options_A321-252N engine_options_A321-253N engine_options_A318-111 engine_options_A318-112 engine_options_A318-121 engine_options_A318-122 engine_options_A319-111 engine_options_A319-112 engine_options_A319-113 engine_options_A319-114 engine_options_A319-115 engine_options_A319-131 engine_options_A319-132 engine_options_A319-133 engine_options_A320-111 engine_options_A320-211 engine_options_A320-212 engine_options_A320-214 engine_options_A320-215 engine_options_A320-216 engine_options_A320-231 engine_options_A320-232 engine_options_A320-233 engine_options_A321-111 engine_options_A321-112 engine_options_A321-131 engine_options_A321-211 engine_options_A321-212 engine_options_A321-213 engine_options_A321-231 engine_options_A321-232 engine_options_A330-201 engine_options_A330-202 engine_options_A330-203 engine_options_A330-223 engine_options_A330-223F engine_options_A330-243 engine_options_A330-301 engine_options_A330-302 engine_options_A330-303 engine_options_A330-321 engine_options_A330-322 engine_options_A330-323 engine_options_A330-341 engine_options_A330-342 engine_options_A330-343 engine_options_A350-941 engine_options_A380-841 engine_options_A380-842 engine_options_A380-861                                                                 engine_options  clean_cd0  clean_k  clean_e  clean_gears
0  2025-04-12          B789 2025-04-12 16:15:35 2025-04-13 04:33:52        WMKK     Kuala Lumpur International Airport             EHAM                   Amsterdam Schiphol Airport  prc770822360    8100.000000           B789     Boeing 787-9  254000.0  193000.0  128000.0  126400.0  515.0  0.90  13100.0    420.0    260.0     290.0            62.81             5.94            5.77      377.0      60.12   6.27000        32.2   0.09400  single-slotted   23.054241    0.759764             0.9        0.15        0.15        11000.0         0.85       14000.0    turbofan         wing            2.0  Trent 1000-K2                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN     0.022   0.042   0.783       0.014           NaN         NaN        3.029893     254000.0    193000.0    128000.0    126400.0       515.0        0.90         13100.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN  ["GEnx-1B75", "GEnx-1B74", "Trent 1000-K2", "Trent 1000-J2", "Trent 1000-A2"]       0.02    0.042    0.797        0.018
1  2025-04-12          A359 2025-04-12 16:40:41 2025-04-13 03:10:15        ZSPD  Shanghai Pudong International Airport             NZAA                             Auckland Airport  prc770831136   15094.180984           A359  Airbus A350-900  280000.0  205000.0  142400.0  140795.0  340.0  0.89  13100.0    440.0    300.0     350.0            66.80             6.09            5.96      442.0      64.75   6.01358        31.9   0.09672  double-slotted   26.853750    0.738003             0.9        0.15        0.15        11000.0         0.85       15000.0    turbofan         wing            2.0   Trent XWB-84                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN     0.022   0.043   0.783       0.013           NaN         NaN        3.086355     280000.0    205000.0    142400.0    140795.0       340.0        0.89         13100.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            Trent XWB-84                     NaN                     NaN                     NaN                                                                            NaN       0.02    0.042    0.797        0.018
2  2025-04-12          A359 2025-04-12 17:01:38 2025-04-13 06:10:27        ZSPD  Shanghai Pudong International Airport             LEMD                       Madrid Barajas Airport  prc770835414   12480.130288           A359  Airbus A350-900  280000.0  205000.0  142400.0  140795.0  340.0  0.89  13100.0    440.0    300.0     350.0            66.80             6.09            5.96      442.0      64.75   6.01358        31.9   0.09672  double-slotted   26.853750    0.738003             0.9        0.15        0.15        11000.0         0.85       15000.0    turbofan         wing            2.0   Trent XWB-84                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN     0.022   0.043   0.783       0.013           NaN         NaN        3.086355     280000.0    205000.0    142400.0    140795.0       340.0        0.89         13100.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN            Trent XWB-84                     NaN                     NaN                     NaN                                                                            NaN       0.02    0.042    0.797        0.018
3  2025-04-12          B789 2025-04-12 17:53:11 2025-04-13 05:05:13        ZSPD  Shanghai Pudong International Airport             LHBP  Budapest Ferenc Liszt International Airport  prc770844923    1200.204432           B789     Boeing 787-9  254000.0  193000.0  128000.0  126400.0  515.0  0.90  13100.0    420.0    260.0     290.0            62.81             5.94            5.77      377.0      60.12   6.27000        32.2   0.09400  single-slotted   23.054241    0.759764             0.9        0.15        0.15        11000.0         0.85       14000.0    turbofan         wing            2.0  Trent 1000-K2                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN     0.022   0.042   0.783       0.014           NaN         NaN        3.029893     254000.0    193000.0    128000.0    126400.0       515.0        0.90         13100.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN  ["GEnx-1B75", "GEnx-1B74", "Trent 1000-K2", "Trent 1000-J2", "Trent 1000-A2"]       0.02    0.042    0.797        0.018
4  2025-04-12          B789 2025-04-12 18:05:27 2025-04-13 06:23:52        ZSPD  Shanghai Pudong International Airport             LFML                   Marseille Provence Airport  prc770847190    2299.711440           B789     Boeing 787-9  254000.0  193000.0  128000.0  126400.0  515.0  0.90  13100.0    420.0    260.0     290.0            62.81             5.94            5.77      377.0      60.12   6.27000        32.2   0.09400  single-slotted   23.054241    0.759764             0.9        0.15        0.15        11000.0         0.85       14000.0    turbofan         wing            2.0  Trent 1000-K2                      NaN                      NaN                      NaN                      NaN                      NaN                      NaN     0.022   0.042   0.783       0.014           NaN         NaN        3.029893     254000.0    193000.0    128000.0    126400.0       515.0        0.90         13100.0                      NaN                      NaN                      NaN                      NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                      NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN                     NaN  ["GEnx-1B75", "GEnx-1B74", "Trent 1000-K2", "Trent 1000-J2", "Trent 1000-A2"]       0.02    0.042    0.797        0.018
2025-11-07 19:23:56,679 - INFO - --- Data Preprocessing Complete ---
2025-11-07 19:23:56,679 - INFO - --- Estimating Load Factor for Each Flight ---
2025-11-07 19:23:56,680 - INFO - Calculating min and max fuel consumption for each route-aircraft group...
2025-11-07 19:23:56,711 - INFO - Calculating normalized load factor for each flight...
2025-11-07 19:23:56,718 - INFO - Head of data with estimated load factor:
      flight_id origin_icao destination_icao aircraft_type  total_fuel_kg  min_fuel_kg   max_fuel_kg  estimated_load_factor
0  prc770822360        WMKK             EHAM          B789    8100.000000  3039.066400  17800.000000               0.342860
1  prc770831136        ZSPD             NZAA          A359   15094.180984  5375.972384  42767.828904               0.259902
2  prc770835414        ZSPD             LEMD          A359   12480.130288  2428.985160  20832.119784               0.546165
3  prc770844923        ZSPD             LHBP          B789    1200.204432  1200.204432  13199.980792               0.000000
4  prc770847190        ZSPD             LFML          B789    2299.711440  1799.853056  19180.000000               0.028760
2025-11-07 19:23:56,718 - INFO - --- Load Factor Estimation Complete ---
2025-11-07 19:23:56,718 - INFO - --- Calculating Average Load Factor per Airport Pair ---
2025-11-07 19:23:56,722 - INFO - Head of average load factor by airport pair:
  origin_icao destination_icao  average_load_factor
0        CYEG             EHAM             0.500000
1        CYUL             DTTA             0.500000
2        CYUL             MSLP             0.469869
3        CYUL             SKBO             0.377679
4        CYVR             EHAM             0.500000
2025-11-07 19:23:56,722 - INFO - --- Average Load Factor Calculation Complete ---
2025-11-07 19:23:56,723 - INFO - --- Saving Results to data\processed\average_load_factor_by_airport_pair.csv ---
2025-11-07 19:23:56,727 - INFO - Process completed successfully.
